<html metal:use-macro="context/@@admin_template/macros/master">
<div metal:fill-slot="content"
    tal:define="order_by python:request.get('order_by', 'quality')">
    <div class="message" tal:condition="request/msg | nothing" tal:content="request/msg" />
    <h1>Bronnen</h1>
    <p tal:condition="python:order_by == 'quality'">De bronnen staan in volgorde van kwaliteit - de beste staan bovenaan</p>
    <table>
    <tr><th>Id</th><th>URL</th><th>Quality</th><th>actions</th></tr>
    <div tal:repeat="source python:view.repository().get_sources(order_by=order_by, desc=True)" tal:omit-tag="">
        <tr>
            <td>
                <span tal:replace="source/id" />
                <br>
                (<a tal:attributes="href python:view.url(context, 'persons', {'source_id':source.id})"><span tal:replace="python:view.repository().count_biographies(source=source)" /> biografie&euml;n</a>)
            <td>
                <a tal:content="source/url" tal:attributes="href source/url"></a> 
                <br>
                <em>
                <div tal:replace="source/description | nothing" />
            </em>
           </td>
           <td>
          	<tt tal:content="source/quality" /> 
           </td>
            <td>
    <ul>
<li>    <a tal:attributes="href string:${view/url}?action=update_source&source_id=${source/id}">download biographies</a>
<li>    <a tal:attributes="href string:${view/url}?action=download_illustrations&source_id=${source/id}">download illustrations [to the local cache]</a>
<li>    <a tal:attributes="href string:source?source_id=${source/id}">edit</a>
<li>    <a tal:attributes="href string:${view/url}?action=source_delete&source_id=${source/id}">delete</a>
            </ul>
            </td>
        </tr>

    </div>
    </table>
    <h2>Voeg een nieuwe bron toe</h2>
    <div>
        <form>
        <input type="hidden" name="action" value="add_source"> 
        <table>
            <tr>
                <th>id</th><td> <input type="text" name="source_id" /></td>
            </tr>
            <tr>
                <th>url</th><td> <input type="text" name="url" size="50" /> </td>
            </tr>
            <tr>
                <th>description</th>
                <td><textarea name="description" cols="50"></textarea></td>
            </tr>
            <tr>
            <td /><td>
                <input type="submit" value="voeg nieuwe bron toe" />
            </td>
            </tr>

        </form>
    </div>
</div>
</html>
