<html metal:use-macro="context/@@main_template/macros/master">
    <meta metal:fill-slot="description" name="Description" 
        tal:attributes="content string:Biografieen van ${view/biography/title}" />
    <meta metal:fill-slot="keywords" name="Keywords" 
        tal:attributes="content string:biografie ${view/biography/title}" />
    <title metal:fill-slot="head_title"
        tal:content="structure python:view.biography.title()" ></title> 
    <div metal:fill-slot="content"
    	tal:define="illustraties  python:view.biography.get_illustrations()"
    	>
    <div class="column_right">
    <div class="illustratie" tal:repeat="ill python:illustraties[:]">
    <img
        tal:attributes="src ill/cached_url; 
            alt string:illustratie bij deze biografie (${ill/cached_url});
      " /> 
    </div>
    </div>
    <div class="illustratie" tal:condition="not:illustraties">
        <div class="geenplaatje"></div>
    </div>
    <div id="bioinfo" >
    <h1 tal:content="structure python:view.biography.naam() and view.biography.naam().guess_normal_form2()" ></h1>
    <table class="leefjaren">
       <tal:block define="
	       event python:view.get_event('birth');
   			title string:geboren;">
       	<tr metal:define-macro="event"
       		tal:condition="python:event and (event.when or event.place or event.date_text)">
            <th tal:content="title">title</th>
            <td>
             <span tal:replace="event/place" /><br tal:condition="event/place">
            <span tal:replace="python:event.when_formatted or event.date_text" />
             </td>
         </tr>
		</tal:block>
      <tal:block define="
	       event python:view.get_event('baptism');
   			title string:gedoopt;">
   			<tr metal:use-macro="template/macros/event" />
   		</tal:block>
       <tal:block define="
	       event python:view.get_event('funeral');
   			title string:begraven;">
   			<tr metal:use-macro="template/macros/event" />
   		</tal:block>
       <tal:block define="
	       event python:view.get_event('death');
   			title string:gestorven;">
   			<tr metal:use-macro="template/macros/event" />
   		</tal:block>
        <tr tal:define="state python:view.get_state(type='floruit')"
            tal:condition="python:state and state.has_content()">
            <th>actief</th>
            <td>
                <span 
                    tal:condition="not:state/text"
                    tal:replace="python:view.context.format_dates(state.frm, state.to, parenthesis=False)" />
                <span tal:condition="state/text" tal:content="structure string:${state/text}" />
                <span tal:condition="state/place" tal:content="structure string:<br />${state/place}" />
            </td>
        </tr>
        <tr tal:condition="python:len(view.biography.get_names()) > 1">
            <th>naamsvarianten</th>
            <td>
            <ul><li tal:repeat="naam python:view.biography.get_names()"
                tal:content="structure python:naam.volledige_naam()"/>
            </ul>
            </td>
        </tr>
        <tr tal:define="sexes python:['onbekend', 'man', 'vrouw'];
                sex python:view.biography.get_value('geslacht')"
            tal:condition="python:sex and sex in ['1','2']">
            <th>sekse</th>
            <td>
            <ul><li><span tal:replace="python:sexes[int(sex)]" /></ul>
            </td>
        </tr>
        <tr tal:condition="python:False and view.biography.get_value('beroep')">
            <th>Beroepen en functies</th>
            <td>
            <ul><li tal:repeat="beroep python:view.biography.get_value('beroep')" 
                tal:content="structure beroep" /></ul>
            </td>
        </tr>
        <tr tal:define="states python:view.get_states(type='category')"
            tal:condition="states">
            <th>rubriek(en)</th>
            <td>
                <li tal:repeat="state states" tal:content="state/text" />
	        </td>
        </tr>
     </table>
    <div class="levensbeschrijvingen">
    <h2>levensbeschrijving(en)</h2>
    <hr />
    <div tal:repeat="biography view/person/get_biographies" tal:omit-tag="">
    <div
        class="biography_reference"
        tal:condition="python:biography.source_id != 'bioport'">
        Biografie
        <span tal:condition="python:biography.get_value('auteur')">
        	door
            <span tal:repeat="auteur python:biography.get_value('auteur')" 
                tal:content="structure auteur" />
        </span>
        <span>
			in  <a 
            tal:attributes="href python:biography.get_value('url_biografie')"
			     class="external_link"
			     target="_blank"
                    tal:content="python:biography.get_source().description"></a>
    	</span>
    	<div class="snippet"
    		tal:define="snippet biography/snippet"
            tal:condition="snippet">
             <span tal:replace="structure snippet" />
             <a  tal:attributes="href python:biography.get_value('url_biografie')"
             target="_blank"
                class="external_link">meer...</a>
           </div>
        </div>
    </div>
    </div>
    <div class="belowbios" tal:condition="nothing"
         tal:content="structure provider:belowbios" />
    <div>
        <a class="backbutton" onClick="alert('terug naar de zoekresultaten (indien van toepassing). Moet nog geimplementeerd.')">terug naar de zoekresultaten</a></div>    
    
    <tt tal:condition="context/debug">
    <br />
    <br />
    <br />
    <hr>
    <a tal:attributes="href python:view.url(context['admin'], 'persoon', data={'bioport_id':view.bioport_id})" >bewerk de gegevens van deze persoon</a>
    <pre>Debug information</pre>
    <pre>
    redirects_to: <tt tal:content="python:view.person.redirects_to()" />
    </pre>
<br />
<br />
<pre tal:repeat="bio view/person/get_biographies"  tal:content="bio/to_string"  /> 
    </tt> 

</div>
</div>
</html>
